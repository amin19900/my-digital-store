<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>متجري الرقمي</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      margin: 0; background: #f9f9f9;
    }
    header {
      background: #007bff;
      color: white;
      padding: 15px 20px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      flex-wrap: wrap;
    }
    .logo {
      font-weight: bold;
      font-size: 22px;
    }
    nav a {
      color: white;
      margin-left: 15px;
      cursor: pointer;
      text-decoration: none;
      font-size: 16px;
      transition: color 0.3s;
    }
    nav a:hover {
      color: #cce5ff;
    }
    .lang-flags img {
      width: 30px;
      height: 20px;
      cursor: pointer;
      border-radius: 3px;
      border: 1px solid white;
      margin-left: 10px;
      transition: transform 0.3s;
    }
    .lang-flags img:hover {
      transform: scale(1.1);
    }
    #content {
      padding: 30px 20px;
      max-width: 900px;
      margin: auto;
      background: white;
      border-radius: 8px;
      box-shadow: 0 0 12px rgba(0,0,0,0.1);
      min-height: 300px;
    }
  </style>
</head>
<body>

<header>
  <div class="logo" id="siteName">متجري الرقمي</div>
  <nav>
    <a href="#" onclick="loadPage('home', true)">الرئيسية</a>
    <a href="#" onclick="loadPage('ads', true)">الإعلانات</a>
    <a href="#" onclick="loadPage('chat', true)">الدردشة</a>
    <a href="#" onclick="loadPage('auth', true)">تسجيل الدخول</a>
  </nav>
  <div class="lang-flags">
    <img src="flags/ma.png" alt="ar" onclick="changeLanguage('ar')" />
    <img src="flags/fr.png" alt="fr" onclick="changeLanguage('fr')" />
    <img src="flags/us.png" alt="en" onclick="changeLanguage('en')" />
  </div>
</header>

<div id="content">
  <!-- المحتوى المحمل ديناميكياً -->
</div>

<script>
  const translations = {
    ar: {
      siteName: "متجري الرقمي",
      homeTitle: "مرحبا بك في الصفحة الرئيسية",
      homeDesc: "هذا هو المحتوى الافتراضي.",
      adsTitle: "صفحة الإعلانات",
      adsDesc: "هنا تعرض الإعلانات.",
      chatTitle: "صفحة الدردشة",
      chatDesc: "تواصل معنا مباشرة.",
      authTitle: "تسجيل الدخول",
      authDesc: "من فضلك سجل دخولك للمتابعة."
    },
    fr: {
      siteName: "Ma Boutique Digitale",
      homeTitle: "Bienvenue à la page d'accueil",
      homeDesc: "Ceci est le contenu par défaut.",
      adsTitle: "Page des annonces",
      adsDesc: "Ici vous trouvez les annonces.",
      chatTitle: "Page de chat",
      chatDesc: "Contactez-nous directement.",
      authTitle: "Connexion",
      authDesc: "Veuillez vous connecter pour continuer."
    },
    en: {
      siteName: "My Digital Store",
      homeTitle: "Welcome to the home page",
      homeDesc: "This is the default content.",
      adsTitle: "Ads Page",
      adsDesc: "Here you find the ads.",
      chatTitle: "Chat Page",
      chatDesc: "Contact us directly.",
      authTitle: "Login",
      authDesc: "Please login to continue."
    }
  };

  let currentLang = localStorage.getItem('siteLang') || 'ar';

  function changeLanguage(lang) {
    currentLang = lang;
    localStorage.setItem('siteLang', lang);
    applyLanguage();
    loadPage(currentPage, false);
  }

  function applyLanguage() {
    document.getElementById('siteName').textContent = translations[currentLang].siteName;
  }

  let currentPage = 'home';

  async function loadPage(page, pushState = false) {
    currentPage = page;
    const t = translations[currentLang];

    // تحديث عنوان الصفحة حسب الصفحة واللغة
    let titleMap = {
      home: t.homeTitle,
      ads: t.adsTitle,
      chat: t.chatTitle,
      auth: t.authTitle
    };
    document.title = titleMap[page] || t.siteName;

    // جلب المحتوى من ملفات html منفصلة (محتوى بسيط بدون <html>)
    try {
      const response = await fetch(page + '.html');
      if (!response.ok) throw new Error('صفحة غير موجودة');
      const html = await response.text();
      document.getElementById('content').innerHTML = html;
    } catch (e) {
      document.getElementById('content').innerHTML = `<h1>خطأ</h1><p>${e.message}</p>`;
    }

    if(pushState) {
      history.pushState({page: page}, '', '#' + page);
    }
  }

  // استماع لتغيير الحالة عند استخدام أزرار المتصفح (رجوع/تقدم)
  window.addEventListener('popstate', event => {
    if(event.state && event.state.page) {
      loadPage(event.state.page, false);
    } else {
      loadPage('home', false);
    }
  });

  // تهيئة الموقع أول مرة
  applyLanguage();
  let hashPage = location.hash.replace('#', '');
  if(hashPage) {
    loadPage(hashPage, false);
  } else {
    loadPage('home', false);
  }
</script>

</body>
</html>
